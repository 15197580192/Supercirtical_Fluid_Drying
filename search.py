import requests
from bs4 import BeautifulSoup
import time
import csv

headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3'}


def search_expert_info(expert_name):
    url = f'https://www.baidu.com/s?wd={expert_name}+毕业院校+研究方向'
    try:
        response = requests.get(url, headers=headers)
        response.raise_for_status()
        soup = BeautifulSoup(response.text, 'html.parser')
        results = soup.get_text()
        return results
    except requests.RequestException as e:
        print(f"请求出错: {e}")
        return None


def extract_info(text):
    school = ""
    research_direction = ""

    # 简单示例：假设文本中包含“毕业于”和“研究方向”
    school_start = text.find("工作于")
    if school_start != -1:
        school_start += 3
        school_end = text.find(" ", school_start)
        if school_end == -1:
            school = text[school_start:]
        else:
            school = text[school_start:school_end]

    direction_start = text.find("研究方向")
    if direction_start != -1:
        direction_start += 4
        research_direction = text[direction_start:].split("\n")[0]

    return school, research_direction


# experts = [
#     "艾渤", "安平", "白亮", "白翔", "柏连发", "毕晓君", "蔡伯根", "蔡成涛", "蔡军", "蔡瑞初", "蔡新霞", "曹进德"]


experts = [
    "艾渤", "安平", "白亮", "白翔", "柏连发", "毕晓君", "蔡伯根", "蔡成涛", "蔡军", "蔡瑞初", "蔡新霞", "曹进德",
    "曹汛", "曾和平", "曾晓洋", "曾志刚", "查正军", "常超", "常胜江", "车伟伟", "车文荃", "陈峰", "陈烽", "陈刚",
    "陈根祥", "陈弘", "陈红胜", "陈华伟", "陈佳宁", "陈建新", "陈健", "陈晶", "陈军宁", "陈谋", "陈平", "陈前斌",
    "陈钱", "陈文超", "陈熙霖", "陈小龙", "陈晓峰", "陈云", "陈云霁", "陈长汶", "成秀珍", "程建功", "程亮",
    "程强", "程鑫彬", "程玉华", "迟楠", "仇洪冰", "仇晓兰", "崔庆华", "崔铁军", "戴道锌", "戴华东", "戴庆",
    "单崇新", "邓成", "邓方", "邓少芝", "邓晓衡", "邓志红", "丁大伟", "丁国如", "丁进良", "丁志华", "董超",
    "董大明", "董海荣", "董宏丽", "董毅", "窦春霞", "窦勇", "杜博", "杜军朝", "杜兰", "杜世萱", "杜文莉",
    "段广仁", "段海滨", "段培永", "樊鑫", "范举", "方俊彬", "方乐缘", "方黎明", "方勇纯", "方玉明", "方志军",
    "房斌", "冯晶", "冯恺宇", "冯全源", "冯伟", "伏虎", "付琨", "付跃刚", "付云起", "傅洛伊", "高会军",
    "高琳", "高西奇", "高新波", "高阳", "高云君", "葛宁", "葛泉波", "耿新", "谷延锋", "顾斌", "关键",
    "关新平", "管海兵", "管晓宏", "管子玉", "郭兵", "郭晨娟", "郭雷", "郭茂祖", "郭延文", "韩红桂", "韩鸿宾",
    "韩家广", "韩军伟", "韩银和", "郝群", "何斌", "何军", "何良华", "何田", "何潇", "何业军", "何勇",
    "何源", "何昭水", "黑新宏", "洪日昌", "洪伟", "洪奕光", "胡斌", "胡昌华", "胡程", "胡德文", "胡封晔",
    "胡贵军", "胡俊", "胡亮", "胡清华", "胡伟达", "胡卫明", "胡永利", "胡钰林", "胡章贵", "华长春",
    "黄惠", "黄家玮", "黄卡玛", "黄磊", "黄庆明", "黄欣沂", "黄志明", "纪荣嵘", "纪越峰", "贾敏", "贾锁堂",
    "江风益", "江涛", "姜斌", "蒋朝辉", "蒋刚毅", "蒋庆华", "蒋田仔", "焦建彬", "金晶", "金梁", "康凯",
    "孔令讲", "况晓辉", "来新泉", "兰旭光", "雷建军", "雷娜", "雷文强", "黎大兵", "黎华", "李步洪",
    "李朝晖", "李成林", "李灯熬", "李东升", "李繁飙", "李飞飞", "李鸿一", "李华伟", "李健兵", "李进",
    "李克勤", "李泠", "李敏", "李树涛", "李伟", "李文昊", "李文雪", "李翔", "李向阳", "李潇", "李晓维",
    "李学龙", "李浥东", "李永明", "李哲涛", "李舟", "厉力华", "梁栋", "梁静", "梁荣华", "梁一韬",
    "廖明帜", "刘斌", "刘宏", "刘宏伟", "刘洪海", "刘佳琪", "刘建国", "刘建明", "刘军", "刘丽炜",
    "刘连庆", "刘美成", "刘妹琴", "刘明", "刘且根", "刘三女牙", "刘淑君", "刘烃", "刘挺", "刘伟涛",
    "刘新宇", "刘秀玲", "刘秀龙", "刘艳军", "刘益春", "刘永", "刘永坚", "刘玉芳", "刘元安", "刘越",
    "刘允刚", "刘哲", "刘哲理", "刘志勇", "刘准钆", "龙桂鲁", "龙军", "卢湖川", "卢孝强", "陆延青",
    "栾小丽", "罗国清", "罗洪斌", "罗均", "罗喜召", "罗小元", "罗迎", "罗钟铉", "吕金虎", "吕志伟",
    "马建华", "马凯学", "马泳", "马欲飞", "马卓", "毛建旭", "毛睿", "梅涛", "孟丹", "孟利民", "孟维晓",
    "缪峰", "缪旻", "莫则尧", "那靖", "尼玛扎西", "牛凯", "潘曹峰", "潘成胜", "潘纲", "潘林强", "潘时龙",
    "潘世烈", "潘炜", "裴海龙", "裴丽", "彭飞", "彭艳", "彭宇新", "蒲戈光", "蒲明博", "蒲涛", "钱丽萍",
    "钱宇华", "乔红", "乔俊飞", "乔学光", "秦兵", "秦家虎", "秦静", "秦雷", "秦志光", "邱海霞", "邱钧",
    "屈军乐", "瞿逢重", "饶峰", "桑胜波", "商烁", "尚学群", "邵建达", "邵金友", "邵士海", "申恒涛",
    "沈波", "沈定刚", "沈纲祥", "沈红斌", "盛敏", "施毅", "石宣化", "束锋", "司小胜", "宋爱国",
    "宋爱民", "宋文龙", "宋志棠", "苏厚胜", "苏洲", "粟梅", "孙方稳", "孙健", "孙杰", "孙乐", "孙玲玲",
    "孙凝晖", "孙鹏", "孙希明", "孙学宏", "孙尧", "孙玉发", "汤庆鑫", "唐金辉", "唐明", "唐万斌",
    "唐小虎", "唐卓", "陶梅霞", "陶然", "陶晓明", "田超", "田聪", "田大新", "田捷", "田奇", "汪宏",
    "汪莱", "汪萌", "汪鹏君", "汪小我", "王大轶", "王国胤", "王海", "王贺升", "王宏强", "王洪凯",
    "王吉华", "王建浦", "王建新", "王井东", "王军", "王军波", "王均宏", "王开友", "王可泽", "王亮",
    "王美琴", "王密", "王鹏飞", "王璞", "王冉冉", "王尚广", "王新强", "王妍", "王耀南", "王祎", "王屹山",
    "王涌天", "王友清", "王宇", "王占山", "韦玮", "位寅生", "魏庆来", "魏志义", "文继荣", "文双春",
    "翁健", "邬向前", "巫英才", "吴爱国", "吴枫", "吴江来", "吴黎兵", "吴立刚", "吴林晟", "吴南健",
    "吴启晖", "吴仁彪", "吴松", "吴小俊", "吴新宇", "吴秀龙", "吴一辉", "吴一戎", "吴永清", "吴语茂",
    "吴长锋", "伍冬睿", "奚磊", "夏明耀", "夏善红", "夏银水", "肖甫", "谢冰", "谢晖", "谢鲲", "谢黎明",
    "谢庆国", "熊红凯", "徐丰", "徐海阳", "徐宏力", "徐淮良", "徐科", "徐坤", "徐立军", "徐明亮",
    "徐胜元", "徐天添", "徐文渊", "徐现刚", "徐昕", "许峰", "许宁生", "许秀来", "许岩岩", "薛晨阳",
    "薛建儒", "鄢社锋", "颜辉", "杨彬", "杨晨阳", "杨德仁", "杨光红", "杨华中", "杨金生", "杨晋玲",
    "杨敬钰", "杨鲲", "杨旗", "杨武", "叶保留", "叶杰平", "叶齐祥", "殷洪玺", "银振强", "尹一通",
    "尤肖虎", "于海斌", "于宗光", "余航", "余少华", "余正涛", "俞建成", "俞俊", "俞祝良", "虞文武",
    "喻俊志", "袁野", "云峰", "詹乃军", "詹志辉", "张彩虹", "张朝阳", "张承慧", "张大伟", "张道强",
    "张锋巍", "张桂戌", "张海君", "张海涛", "张海霞", "张皓", "张贺晔", "张吉良", "张健", "张靖",
    "张举勇", "张蕾", "张立军", "张民", "张尼", "张平", "张勤远", "张群", "张寿", "张珽", "张伟",
    "张伟力", "张卫东", "张文栋", "张向东", "张兴义", "张雪波", "张艳宁", "张永伟", "张勇刚", "张源涛",
    "张铮", "章秀银", "章毅", "赵春晖", "赵刚", "赵海涛", "赵慧洁", "赵珺", "赵尚弘", "赵巍胜", "赵伟",
    "赵小兵", "赵兴明", "赵延龙", "赵永强", "赵勇", "赵元富", "郑春厚", "郑南宁", "郑小平", "郑钰辉",
    "郑元杰", "郑铮", "钟伟民", "周傲英", "周郭许", "周海波", "周建华", "周骏", "周昆", "周亮", "周璐",
    "周鹏", "周朴", "周文超", "周永彬", "朱洪波", "朱鲁华", "朱涛", "朱文武", "朱亦鸣", "朱樟明",
    "庄越挺", "訾斌", "邹卫文", "邹喜华", "邹玉龙", "左敏"
]

with open('experts_info.csv', 'w', newline='', encoding='utf-8-sig') as csvfile:
    fieldnames = ['专家姓名', '学校', '研究方向']
    writer = csv.DictWriter(csvfile, fieldnames=fieldnames)

    writer.writeheader()

    for expert in experts:
        writer.writerow({
            '专家姓名': expert,
            # '学校': school,
            # '研究方向': research_direction
        })
        # info = search_expert_info(expert)
        # if info:
        #     school, research_direction = extract_info(info)
        #     writer.writerow({
        #         '专家姓名': expert,
        #         '学校': school,
        #         '研究方向': research_direction
        #     })
        # time.sleep(1)
